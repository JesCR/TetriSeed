<!-- Generated by SpecStory -->

# Tetris Scoring and SuperSeed Implementation (2025-04-07 16:37:17)

_**User**_

i want to implement the original tetris puntuation, with more score if player does multiple lines, like 1 (Single): 4, 
2 (Double): 10, 3 (Triple): 30, 4 (Tetris): 120. Can you do that? and also show a "SuperSeed!" in big bright blue at the bottom of the game area when the player mades 4 lines (tetris)?

---

_**Assistant**_



---

<details>
            <summary>Searched codebase "useGameStatus.js" • **1** results</summary>
        
| File |
|------|
| `undefined` |

</details>

---

Read file: src/hooks/useGameStatus.js

---

<details>
            <summary>Searched codebase "How tetris displays messages or animations during gameplay" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/components/Tetris.jsx` | L1197-1216 |
| `src/components/Tetris.jsx` | L1104-1129 |
| `.specstory/history/2025-04-02_17-16-summarizing-updates-for-twitter.md` | L187-262 |
| `src/index.css` | L270-330 |
| `src/hooks/useStage.js` | L1-51 |
| `src/components/Tetris.jsx` | L438-493 |
| `src/components/Tetris.jsx` | L30-82 |
| `src/components/Tetris.jsx` | L616-659 |
| `.specstory/history/2025-03-27_17-37-creating-tetriseed-clear-your-debt-game.md` | L4797-4857 |
| `src/components/Tetris.jsx` | L659-709 |
| `.specstory/history/2025-03-27_17-37-creating-tetriseed-clear-your-debt-game.md` | L3293-3372 |
| `src/components/Tetris.jsx` | L1129-1167 |
| `src/hooks/useStage.js` | L98-158 |
| `src/components/Tetris.jsx` | L709-761 |
| `src/App.css` | L1-97 |
| `src/components/Tetris.jsx` | L173-227 |
| `src/components/Tetris.jsx` | L1216-1243 |
| `src/utils/tetrisUtils.js` | L136-141 |
| `.specstory/history/2025-03-27_17-37-creating-tetriseed-clear-your-debt-game.md` | L2152-2213 |
| `src/utils/tetrisUtils.js` | L1-61 |
| `src/index.css` | L1078-1153 |
| `src/components/Tetris.jsx` | L576-616 |
| `.specstory/history/2025-03-27_17-37-creating-tetriseed-clear-your-debt-game.md` | L4857-4915 |
| `public/index.html` | L1-62 |
| `.specstory/history/2025-04-03_10-30-custom-game-over-messages.md` | L532-582 |

</details>

---

Read file: src/components/Stage.jsx

---

```diff
    const [rows, setRows] = useState(0);
    const [level, setLevel] = useState(1);
+   const [tetrisCleared, setTetrisCleared] = useState(false);
  
-   // Scoring constants - add points per line + linePoints for multiple lines at once
-   const POINTS_PER_LINE = 10;
-   const linePoints = [40, 100, 300, 1200]; // Bonus for multiple lines
+   // Scoring constants - original Tetris scoring system
+   const linePoints = [0, 40, 100, 300, 1200]; // Puntuación por líneas: 0, 1, 2, 3, 4 líneas
  
    const calcScore = useCallback(() => {
      // Check if we have rows cleared
      if (rowsCleared > 0) {
-       // Add score based on number of cleared rows
-       setScore(prev => prev + (rowsCleared * POINTS_PER_LINE));
+       // Actualizar el estado de tetris completado
+       setTetrisCleared(rowsCleared === 4);
+       
+       // Aplicar puntuación original del Tetris, multiplicada por el nivel actual
+       setScore(prev => prev + (linePoints[rowsCleared] * level));
      }
-   }, [rowsCleared, POINTS_PER_LINE]);
+   }, [rowsCleared, linePoints, level]);
  
    useEffect(() => {
    }, [level, rows]);
  
-   return [score, setScore, rows, setRows, level, setLevel];
+   return [score, setScore, rows, setRows, level, setLevel, tetrisCleared, setTetrisCleared];
  }; 
```

---

Read file: src/utils/tetrisUtils.js

---

```diff
    const [player, updatePlayerPos, resetPlayer, playerRotate, nextTetromino] = usePlayer();
    const [stage, setStage, rowsCleared, message, showMessage, interestMessage, showInterestMessage, showInterestRateMessage] = useStage(player, resetPlayer);
-   const [score, setScore, rows, setRows, level, setLevel] = useGameStatus(rowsCleared);
+   const [score, setScore, rows, setRows, level, setLevel, tetrisCleared, setTetrisCleared] = useGameStatus(rowsCleared);
    const [scoreInfo, setScoreInfo] = useState({ score: 0, rank: null });
  
    const keyDownIntervalRef = useRef(null);
    const isKeyDownPressedRef = useRef(false);
+ 
+   // Agregamos estado para mostrar el mensaje de SuperSeed!
+   const [showSuperSeedMessage, setShowSuperSeedMessage] = useState(false);
  
    // Submit score to the leaderboard - no dependencies to avoid circular references
      setRows(0);
      setLevel(1); // Start at level 1 instead of 0
+     setShowSuperSeedMessage(false); // Asegurarse de que el mensaje no se muestre al iniciar
+     setTetrisCleared(false); // Resetear el estado de Tetris completado
      
      // Show initial interest rate message for level 1
      }
    };
+ 
+   // Añadir un efecto para mostrar el mensaje de SuperSeed! cuando se hace un Tetris
+   useEffect(() => {
+     if (tetrisCleared) {
+       // Mostrar el mensaje SuperSeed!
+       setShowSuperSeedMessage(true);
+       
+       // Ocultar el mensaje después de 2 segundos
+       setTimeout(() => {
+         setShowSuperSeedMessage(false);
+         // Resetear el estado para futuros Tetris
+         setTetrisCleared(false);
+       }, 2000);
+     }
+   }, [tetrisCleared, setTetrisCleared]);
  
    return (
            
            <div className="game-content">
+             {/* Mensaje de SuperSeed! que aparece cuando se hace un Tetris */}
+             {showSuperSeedMessage && (
+               <div className="super-seed-message">SuperSeed!</div>
+             )}
+             
              {/* Conditional rendering based on mobile or desktop */}
              {isMobile ? (
```

---

```diff
    }
  }
+ 
+ /* ... existing code ... */
+ 
+ /* Super Seed Message (cuando se completa un Tetris) */
+ .super-seed-message {
+   position: fixed;
+   bottom: 10%;
+   left: 50%;
+   transform: translateX(-50%);
+   font-size: 3rem;
+   font-weight: bold;
+   color: #00bfff; /* Azul brillante */
+   text-shadow: 
+     0 0 10px #00bfff,
+     0 0 20px #00bfff,
+     0 0 30px #00bfff,
+     0 0 40px #0088ff,
+     0 0 50px #0088ff;
+   animation: pulseTetris 0.5s infinite alternate;
+   z-index: 1000;
+   font-family: 'Press Start 2P', cursive, sans-serif;
+   letter-spacing: 2px;
+   background-color: rgba(0, 0, 0, 0.6);
+   padding: 0.5rem 1rem;
+   border-radius: 8px;
+   white-space: nowrap;
+ }
+ 
+ @keyframes pulseTetris {
+   from {
+     opacity: 0.8;
+     transform: translateX(-50%) scale(0.95);
+   }
+   to {
+     opacity: 1;
+     transform: translateX(-50%) scale(1.05);
+   }
+ }
  
  /* ... existing code ... */
```

---

```bash
cat package.json | grep name
```

```
PS D:\GIT\TetriSeed> cat package.json | grep name
grep : El término 'grep' no se reconoce como nombre de un cmdlet, función, archivo de script o programa 
ejecutable. Compruebe si escribió correctamente el nombre o, si incluyó una ruta de acceso, compruebe que 
dicha ruta es correcta e inténtelo de nuevo.
En línea: 1 Carácter: 20
+ cat package.json | grep name
+                    ~~~~
    + CategoryInfo          : ObjectNotFound: (grep:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS D:\GIT\TetriSeed>
```

---

```bash
cat package.json | findstr name
```

```
PS D:\GIT\TetriSeed> cat package.json | findstr name
PS D:\GIT\TetriSeed>
```

---

```bash
cat package.json
```

```
PS D:\GIT\TetriSeed> cat package.json
{
  "name": "tetriseed",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview",
    "server": "node server/index.js",
    "start": "npm run server & npm run dev -- --host",
    "cleanup-leaderboard": "node server/cleanup-leaderboard.js"
  },
  "dependencies": {
    "cors": "^2.8.5",
    "csv-parse": "^5.6.0",
    "csv-parser": "^3.2.0",
    "csv-stringify": "^6.5.2",
    "csv-writer": "^1.6.0",
    "ethers": "^5.7.2",
    "express": "^4.21.2",
    "html2canvas": "^1.4.1",
    "node-fetch": "^3.3.2",
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@eslint/js": "^9.21.0",
    "@types/react": "^19.0.10",
    "@types/react-dom": "^19.0.4",
    "@vitejs/plugin-react": "^4.3.4",
    "dotenv": "^16.4.7",
    "eslint": "^9.21.0",
    "eslint-plugin-react-hooks": "^5.1.0",
    "eslint-plugin-react-refresh": "^0.4.19",
    "globals": "^15.15.0",
    "vite": "^6.2.0"
  }
}
PS D:\GIT\TetriSeed>
```

---

Cancelled

---

¡Listo! He implementado la puntuación original de Tetris y añadido el mensaje "SuperSeed!" para cuando completas un Tetris (4 líneas a la vez). Aquí están los cambios realizados:

1. **Sistema de puntuación actualizado:**
   - 1 línea (Single): 40 × nivel
   - 2 líneas (Double): 100 × nivel
   - 3 líneas (Triple): 300 × nivel
   - 4 líneas (Tetris): 1200 × nivel

2. **Mensaje "SuperSeed!" para Tetris:**
   - Aparece cuando completas 4 líneas de una vez
   - Se muestra en azul brillante con efecto pulsante
   - Aparece en la parte inferior del área de juego
   - Desaparece automáticamente después de 2 segundos

3. **Implementación técnica:**
   - Agregué un nuevo estado `tetrisCleared` en el hook `useGameStatus`
   - Creé un efecto para mostrar/ocultar el mensaje cuando ocurre un Tetris
   - Añadí estilos CSS para el mensaje con animación y efectos visuales

Para probar los cambios, juega al Tetris y completa 4 líneas de una vez para ver el mensaje "SuperSeed!" en azul brillante. También notarás que la puntuación ahora sigue el sistema original de Tetris, donde los Tetris (4 líneas) son mucho más valiosos que las líneas individuales.

---



---

